#!/usr/bin/env ruby
# encoding: utf-8
require_relative 'anecdot'

def moscow_time
  (Time.now.utc + 3*60*60).strftime("%H:%M:%S (%d.%m.%Y)")
end

def show_menu(name)
  puts "\n–ß–µ–º –µ—â–µ –º–æ–≥—É –ø–æ–º–æ—á—å, #{name}? –í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç:"
  puts "1. –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –∞–Ω–µ–∫–¥–æ—Ç"
  puts "2. –ü–æ–∫–∞–∑–∞—Ç—å –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è"
  puts "3. –ü–æ–∂–µ–ª–∞—Ç—å –¥–æ–±—Ä–æ–≥–æ —É—Ç—Ä–∞"
  puts "4. –ü–æ–∂–µ–ª–∞—Ç—å —Å–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏"
  puts "5. –í—ã—Ö–æ–¥"
end

def show_joke_categories
  puts "\n–í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∞–Ω–µ–∫–¥–æ—Ç–∞:"
  Anecdote::CATEGORIES.each do |num, category|
    puts "#{num}. #{category}"
  end
  puts "0. –õ—é–±–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"
end

def main_menu(name)
  loop do
    show_menu(name)
    choice = gets.chomp

    case choice
    when "1"
      puts "\n–ò—â—É –ª—É—á—à–∏–π –∞–Ω–µ–∫–¥–æ—Ç –¥–ª—è —Ç–µ–±—è..."
      if joke = Anecdote.get_random_joke
        puts "\n#{joke}"
      else
        puts "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –∞–Ω–µ–∫–¥–æ—Ç üòî"
      end
      puts "\n–ß–µ–º –µ—â—ë –º–æ–≥—É –ø–æ–º–æ—á—å?"
    when "2"
      puts "\n–¢–µ–∫—É—â–µ–µ –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è: #{moscow_time}"
      puts "\n–ß—Ç–æ-—Ç–æ –µ—â–µ?"
    when "3"
      puts "\n#{name}, –∂–µ–ª–∞—é —Ç–µ–±–µ —Å–∞–º–æ–≥–æ —Å–æ–ª–Ω–µ—á–Ω–æ–≥–æ –∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ —É—Ç—Ä–∞! üåû"
      puts "–ü—É—Å—Ç—å –¥–µ–Ω—å –Ω–∞—á–Ω—ë—Ç—Å—è —Å —Ö–æ—Ä–æ—à–µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –ø—Ä–∏—è—Ç–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π!"
      puts "\n–ú–æ–≥—É –µ—â–µ —á–µ–º-—Ç–æ –ø–æ–º–æ—á—å?"
    when "4"
      puts "\n–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏, #{name}! üåô"
      puts "–ü—É—Å—Ç—å —Ç–µ–±–µ —Å–Ω—è—Ç—Å—è –ø—Ä–∏—è—Ç–Ω—ã–µ —Å–Ω—ã, –∞ –∑–∞–≤—Ç—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å –±—É–¥–µ—Ç –µ—â—ë –ª—É—á—à–µ!"
      puts "\n–•–æ—á–µ—à—å —á—Ç–æ-—Ç–æ –µ—â–µ –ø–µ—Ä–µ–¥ —Å–Ω–æ–º?"
    when "5"
      puts "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è, #{name}! –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è, –µ—Å–ª–∏ –±—É–¥—É—Ç –≤–æ–ø—Ä–æ—Å—ã!"
      break
    else
      puts "–ù–µ –ø–æ–Ω—è–ª —Ç–≤–æ–µ–≥–æ –≤—ã–±–æ—Ä–∞, –ø–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!"
    end
  end
end

# –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
puts "–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?"
name = gets.chomp
puts "–ü—Ä–∏–≤–µ—Ç, #{name}!"

puts "\n#{name}, —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –æ –º–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö? (–¥–∞/–Ω–µ—Ç)"
answer = gets.chomp.downcase

if answer == "–¥–∞"
  puts "\n–Ø - DeepSeek, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å —Ç–∞–∫–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:"
  puts "- –û—Ç–≤–µ—á–∞—é –Ω–∞ —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ–±—ä—è—Å–Ω—è—é –ø–æ–Ω—è—Ç–∏—è –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏"
  puts "- –ü–æ–º–æ–≥–∞—é —Å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–∞—Ö"
  puts "- –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ"
  puts "- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é –¥–ª–∏–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ (–¥–æ 128K —Ç–æ–∫–µ–Ω–æ–≤)"
  puts "- –£–º–µ—é —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (PDF, Word, Excel –∏ –¥—Ä.)"
  puts "- –í—Å–µ–≥–¥–∞ –±–µ—Å–ø–ª–∞—Ç–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –æ–±—â–µ–Ω–∏—è!"

  puts "\n–ú–æ—è —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: DeepSeek-V3"
  puts "–ú–æ—è –±–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞ –∏—é–ª—å 2024 –≥–æ–¥–∞."

  main_menu(name)
elsif answer == "–Ω–µ—Ç"
  puts "–•–æ—Ä–æ—à–æ, #{name}. –ï—Å–ª–∏ –ø–µ—Ä–µ–¥—É–º–∞–µ—à—å - —Å–ø—Ä–∞—à–∏–≤–∞–π!"
else
  puts "–ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª –≤–∞—à –æ—Ç–≤–µ—Ç, #{name}. –ù–æ –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å –æ –º–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –ø–æ–∑–∂–µ!"
end